var k=Object.defineProperty;var v=e=>{throw TypeError(e)};var E=(e,i,t)=>i in e?k(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t;var n=(e,i,t)=>E(e,typeof i!="symbol"?i+"":i,t),u=(e,i,t)=>i.has(e)||v("Cannot "+t);var c=(e,i,t)=>(u(e,i,"read from private field"),t?t.call(e):i.get(e)),r=(e,i,t)=>i.has(e)?v("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,t),y=(e,i,t,s)=>(u(e,i,"write to private field"),s?s.call(e,t):i.set(e,t),t),d=(e,i,t)=>(u(e,i,"access private method"),t);import{C as x}from"./component.js";import{d as L,o as W,t as C}from"./utilities.js";var l,a,o,g,f;class D extends x{constructor(){super(...arguments);r(this,o);n(this,"requiredRefs",["dialog"]);r(this,l,L(()=>{const{minWidth:t,maxWidth:s}=this;if(!t&&!s)return;const b=window.innerWidth;(b<t||b>s)&&this.closeDialog()},50));r(this,a,0);n(this,"closeDialog",async()=>{const{dialog:t}=this.refs;t.open&&(this.removeEventListener("click",d(this,o,g)),this.removeEventListener("keydown",d(this,o,f)),t.classList.add("dialog-closing"),await W(t,void 0,{subtree:!1}),document.body.style.width="",document.body.style.position="",document.body.style.top="",window.scrollTo({top:c(this,a),behavior:"instant"}),t.close(),t.classList.remove("dialog-closing"),this.dispatchEvent(new w))});n(this,"toggleDialog",()=>{this.refs.dialog.open?this.closeDialog():this.showDialog()})}connectedCallback(){super.connectedCallback(),(this.minWidth||this.maxWidth)&&window.addEventListener("resize",c(this,l))}disconnectedCallback(){super.disconnectedCallback(),(this.minWidth||this.maxWidth)&&window.removeEventListener("resize",c(this,l))}showDialog(){const{dialog:t}=this.refs;if(t.open)return;const s=window.scrollY;y(this,a,s),requestAnimationFrame(()=>{document.body.style.width="100%",document.body.style.position="fixed",document.body.style.top=`-${s}px`,t.showModal(),this.dispatchEvent(new p),this.addEventListener("click",d(this,o,g)),this.addEventListener("keydown",d(this,o,f))})}get minWidth(){return Number(this.getAttribute("dialog-active-min-width"))}get maxWidth(){return Number(this.getAttribute("dialog-active-max-width"))}}l=new WeakMap,a=new WeakMap,o=new WeakSet,g=function(t){const{dialog:s}=this.refs;C(t,s)&&this.closeDialog()},f=function(t){t.key==="Escape"&&(t.preventDefault(),this.closeDialog())};customElements.get("dialog-component")||customElements.define("dialog-component",D);const h=class h extends CustomEvent{constructor(){super(h.eventName)}};n(h,"eventName","dialog:open");let p=h;const m=class m extends CustomEvent{constructor(){super(m.eventName)}};n(m,"eventName","dialog:close");let w=m;document.addEventListener("toggle",e=>{if(e.target instanceof HTMLDetailsElement&&e.target.hasAttribute("scroll-lock")){const{open:i}=e.target;i?document.documentElement.setAttribute("scroll-lock",""):document.documentElement.removeAttribute("scroll-lock")}},{capture:!0});export{D,w as a};
