var nt=Object.defineProperty;var K=r=>{throw TypeError(r)};var rt=(r,o,t)=>o in r?nt(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t;var X=(r,o,t)=>rt(r,typeof o!="symbol"?o+"":o,t),F=(r,o,t)=>o.has(r)||K("Cannot "+t);var i=(r,o,t)=>(F(r,o,"read from private field"),t?t.call(r):o.get(r)),c=(r,o,t)=>o.has(r)?K("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(r):o.set(r,t),p=(r,o,t,e)=>(F(r,o,"write to private field"),e?e.call(r,t):o.set(r,t),t),v=(r,o,t)=>(F(r,o,"access private method"),t);import{C as ot}from"./component.js";import{v as H,c as Z,p as lt,g as dt,m as at,E as tt,a as et,b as ht,k as ut}from"./utilities.js";import{S as ct,s as ft}from"./scrolling.js";import{S as Q}from"./events.js";const mt=.7;var D,k,C,d,L,h,it,st,B,$,W,N,y,P,q,O,Y,G,R;const J=class J extends ot{constructor(){super(...arguments);c(this,h);X(this,"requiredRefs",["scroller"]);c(this,D,0);c(this,k,!1);c(this,C);c(this,d);c(this,L);c(this,B,()=>{const t=i(this,D),e=i(this,N).call(this);if(e===t)return;const s=this.slides?.[e];s&&this.dispatchEvent(new Q({index:e,previousIndex:t,userInitiated:!0,trigger:"scroll",slide:s,id:s.getAttribute("slide-id")}))});c(this,$,()=>{this.setAttribute("transitioning","")});c(this,W,()=>{v(this,h,R).call(this),this.removeAttribute("transitioning")});c(this,N,()=>{const{slides:t}=this;if(!t)return this.current=0;if(!i(this,d))return this.current=0;const e=this.visibleSlides;if(!e.length)return this.current;const{axis:s}=i(this,d),{scroller:a}=this.refs,n=e.map(b=>et(b,s)),u=e.length>1?a.getBoundingClientRect()[s]:et(a,s),f=ht(n,u),S=e[n.indexOf(f)];if(!S)return this.current=0;const E=t.indexOf(S);return this.current=E});c(this,y,!1);c(this,P,t=>{const{slides:e}=this;if(!e||e.length<=1||!(t.target instanceof Element)||this.disabled||i(this,y)||t.target.closest("model-viewer"))return;t.preventDefault();const{axis:s}=i(this,d),a=t[s],n=new AbortController,{signal:u}=n,f=performance.now();let S=a,E=0,b=!1,g=0;p(this,y,!0);const z=A=>{const m=A[s],I=a-m;if(!I)return;if(!b){b=!0,this.setPointerCapture(A.pointerId),document.addEventListener("click",ut,{once:!0,signal:u});const V=I<0,_=I>0,w=this.parentElement?.closest("slideshow-component"),T=w instanceof J&&w!==this,j=V&&this.atStart||_&&this.atEnd;if(T&&j){n.abort();return}this.pause(),this.setAttribute("dragging","")}A.stopImmediatePropagation();const l=S-m,x=performance.now()-f;E=Math.round(l/x*1e3),S=m,g+=Math.abs(l),i(this,d).by(l,{instant:!0})},M=async A=>{n.abort();const{current:m,slides:I}=this,{scroller:l}=this.refs;if(p(this,y,!1),!I?.length||!l)return;const x=Math.sign(E),V=i(this,N).call(this),_=m!==V||Math.abs(E)<10||g<10?0:x,w=Z(V+_,0,I.length-1),T=I[w],j=this.current;if(!T)throw new Error(`Slide not found at index ${w}`);i(this,d).to(T),this.removeAttribute("dragging"),this.releasePointerCapture(A.pointerId),v(this,h,G).call(this,w),this.dispatchEvent(new Q({index:w,previousIndex:j,userInitiated:!0,trigger:"drag",slide:T,id:T.getAttribute("slide-id")})),this.current=w,await i(this,d).finished,!i(this,y)&&(i(this,d).snap=!0,this.resume())};i(this,d).snap=!1,document.addEventListener("pointermove",z,{signal:u}),document.addEventListener("pointerup",M,{signal:u}),document.addEventListener("pointerdown",M,{signal:u}),document.addEventListener("pointercancel",M,{signal:u}),document.addEventListener("pointercapturelost",M,{signal:u})});c(this,q,()=>{this.setAttribute("actioned","")});c(this,O,()=>document.hidden?this.pause():this.resume())}static get observedAttributes(){return["initial-slide"]}attributeChangedCallback(t,e,s){t==="initial-slide"&&e!==s&&queueMicrotask(()=>{if(!this.isConnected||!i(this,d)||!this.refs.slides)return;const a=parseInt(s,10)||0,n=this.refs.slides[a]?.getAttribute("slide-id");n&&this.select({id:n},void 0,{animate:!1})})}async connectedCallback(){if(super.connectedCallback(),H.current&&(await H.current,!this.isConnected))return;(this.slides?.length||0)<=1?v(this,h,it).call(this):v(this,h,st).call(this)}disconnectedCallback(){if(super.disconnectedCallback(),i(this,d)){const{scroller:e}=this.refs;e.removeEventListener("mousedown",i(this,P)),i(this,d).destroy()}(this.slides?.length||0)>1&&(this.removeEventListener("mouseenter",this.suspend),this.removeEventListener("mouseleave",this.resume),this.removeEventListener("pointerenter",i(this,q)),document.removeEventListener("visibilitychange",i(this,O))),i(this,L)&&i(this,L).disconnect()}get isNested(){return this.parentElement?.closest("slideshow-component")!==null}get initialSlide(){return this.refs.slides?.[this.initialSlideIndex]}async select(t,e,s={}){if(i(this,k)||!this.refs.slides?.length||!i(this,d))return;const a=this.slides?.[this.current];for(const l of this.refs.slides)l.hasAttribute("reveal")&&(l.removeAttribute("reveal"),l.setAttribute("aria-hidden","true"));let n=(()=>{if(typeof t=="number")return t;if(typeof t=="string")return parseInt(t,10);if("id"in t){const l=this.refs.slides.find(x=>x.getAttribute("slide-id")==t.id);return!l||!this.slides?void 0:(l.hasAttribute("hidden")&&(l.setAttribute("reveal",""),l.setAttribute("aria-hidden","false")),this.slides.indexOf(l))}})();const{current:u}=this,{slides:f}=this;if(!f?.length||n===void 0||isNaN(n))return;const S=f?.[n];if(a===S)return;this.infinite||(n=Z(n,0,f.length-1)),e?.preventDefault();const{animate:E=!0}=s,b=f.length-1;let g=n;n<0?g=b:n>b&&(g=0);const z=Math.abs(g-u)<=1&&n>=0&&n<=b,{visibleSlides:M}=this,A=lt()||!E;if(!A&&!z&&M.length===1){p(this,k,!0),await i(this,d).finished;const l=f[g];if(!l||!a)return;const x=document.createElement("slideshow-slide");l.before(x),n<u?a.before(l):a.after(l),u===0&&i(this,d).to(a,{instant:!0}),queueMicrotask(async()=>{await i(this,d).finished,p(this,k,!1),x.replaceWith(l),i(this,d).to(l,{instant:!0})})}const m=f[g];if(!m)return;const I=this.current;m.setAttribute("aria-hidden","false"),i(this,d)&&i(this,d).to(m,{instant:A}),this.current=this.slides?.indexOf(m)||0,v(this,h,G).call(this,g,A?"instant":"smooth"),this.dispatchEvent(new Q({index:g,previousIndex:I,userInitiated:e!=null,trigger:"select",slide:m,id:m.getAttribute("slide-id")}))}next(t,e){t?.preventDefault(),this.select(this.nextIndex,t,e)}previous(t,e){t?.preventDefault(),this.select(this.previousIndex,t,e)}play(t=this.autoplayInterval){i(this,C)||(this.paused=!1,p(this,C,setInterval(()=>{this.matches(":hover")||document.hidden||this.next()},t)))}pause(){this.paused=!0,this.suspend()}get paused(){return this.hasAttribute("paused")}set paused(t){t?this.setAttribute("paused",""):this.removeAttribute("paused")}suspend(){clearInterval(i(this,C)),p(this,C,void 0)}resume(){!this.autoplay||this.paused||(this.pause(),this.play())}get autoplay(){return!!this.autoplayInterval}get autoplayInterval(){const t=this.getAttribute("autoplay"),e=parseInt(`${t}`,10);if(!Number.isNaN(e))return e*1e3}get current(){return i(this,D)}set current(t){const{current:e,thumbnails:s,dots:a,slides:n,previous:u,next:f}=this.refs;p(this,D,t),e&&(e.textContent=`${t+1}`);for(const S of[s,a])S?.forEach((E,b)=>E.setAttribute("aria-selected",`${b===t}`));u&&(u.disabled=!this.infinite&&t===0),f&&(f.disabled=!!(!this.infinite&&n&&this.nextIndex>=n.length))}get infinite(){return this.getAttribute("infinite")!=null}get visibleSlides(){return dt(this.refs.scroller,this.slides,mt,"x")}get previousIndex(){const{current:t,visibleSlides:e}=this,s=e.length>1?e.length:1;return t-s}get nextIndex(){const{current:t,visibleSlides:e}=this,s=e.length>1?e.length:1;return t+s}get atStart(){const{current:t,slides:e}=this;return e?.length?t===0:!1}get atEnd(){const{current:t,slides:e}=this;return e?.length?t===e.length-1:!1}set disabled(t){this.setAttribute("disabled",String(t))}get disabled(){return this.getAttribute("disabled")==="true"||this.hasAttribute("mobile-disabled")&&!at.matches}get slides(){return this.refs.slides?.filter(t=>!t.hasAttribute("hidden")||t.hasAttribute("reveal"))}get initialSlideIndex(){const t=this.getAttribute("initial-slide");return t==null?0:parseInt(t,10)}};D=new WeakMap,k=new WeakMap,C=new WeakMap,d=new WeakMap,L=new WeakMap,h=new WeakSet,it=function(){if(this.current=0,this.hasAttribute("auto-hide-controls")){const{slideshowControls:t}=this.refs;t instanceof HTMLElement&&(t.hidden=!0)}this.refs.slides?.[0]&&this.refs.slides[0].setAttribute("aria-hidden","false")},st=function(){const{scroller:t}=this.refs;p(this,d,new ct(t,{onScroll:i(this,B),onScrollStart:i(this,$),onScrollEnd:i(this,W)})),t.addEventListener("mousedown",i(this,P)),this.addEventListener("mouseenter",this.suspend),this.addEventListener("mouseleave",this.resume),this.addEventListener("pointerenter",i(this,q)),document.addEventListener("visibilitychange",i(this,O)),v(this,h,Y).call(this),this.disabled=this.isNested||this.disabled,this.resume(),this.current=this.initialSlideIndex,tt.schedule(()=>{let e=0;const s=this.initialSlide?.getAttribute("slide-id");requestAnimationFrame(()=>{this.initialSlideIndex!==0&&s?(this.select({id:s},void 0,{animate:!1}),e=1):(e=v(this,h,R).call(this),e===0&&(this.select(0,void 0,{animate:!1}),e=1))}),p(this,L,new ResizeObserver(async()=>{H.current&&await H.current,e>1&&v(this,h,R).call(this),this.hasAttribute("auto-hide-controls")&&v(this,h,Y).call(this)})),i(this,L).observe(this.refs.slideshowContainer)})},B=new WeakMap,$=new WeakMap,W=new WeakMap,N=new WeakMap,y=new WeakMap,P=new WeakMap,q=new WeakMap,O=new WeakMap,Y=function(){if(!this.hasAttribute("auto-hide-controls"))return;const{scroller:t,slideshowControls:e}=this.refs;e instanceof HTMLElement&&(e.hidden=t.scrollWidth<=t.offsetWidth)},G=function(t,e="smooth"){const s=this.refs.thumbnails?.[t];if(!s)return;const{thumbnailsContainer:a}=this.refs;if(!a||!(a instanceof HTMLElement))return;const{slideshowControls:n}=this.refs;!n||!(n instanceof HTMLElement)||ft(s,{ancestor:a,behavior:e,block:"center",inline:"center"})},R=function(){const{slides:t}=this;if(!t||!t.length)return 0;const e=this.visibleSlides;return tt.schedule(()=>{t.forEach(s=>{const a=e.includes(s);s.setAttribute("aria-hidden",`${!a}`)})}),e.length};let U=J;customElements.get("slideshow-component")||customElements.define("slideshow-component",U);
