var w=Object.defineProperty;var E=t=>{throw TypeError(t)};var A=(t,a,e)=>a in t?w(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;var f=(t,a,e)=>A(t,typeof a!="symbol"?a+"":a,e),I=(t,a,e)=>a.has(t)||E("Cannot "+e);var n=(t,a,e)=>(I(t,a,"read from private field"),e?e.call(t):a.get(t)),s=(t,a,e)=>a.has(t)?E("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(t):a.set(t,e);import{C as M}from"./component.js";import{n as x,d as b}from"./utilities.js";import{M as C}from"./events.js";const D=0,H=350;var u,i,d,l,m,o,h;class S extends M{constructor(){super(...arguments);f(this,"requiredRefs",["overflowMenu"]);s(this,u,new AbortController);s(this,i,{activeItem:null});f(this,"activate",e=>{n(this,o).cancel(),n(this,l).cancel(),n(this,l).call(this,e)});s(this,d,e=>{if(n(this,o).cancel(),this.dispatchEvent(new C),this.removeAttribute("data-animating"),!(e.target instanceof Element))return;let r=v(e.target);if(!r||r==n(this,i).activeItem)return;const p=e.target.slot==="";this.dataset.overflowExpanded=(!p).toString();const g=n(this,i).activeItem;g&&(g.ariaExpanded="false"),n(this,i).activeItem=r,this.ariaExpanded="true",r.ariaExpanded="true";let c=q(r);!c&&!p&&(c=this.overflowMenu);const y=c?c.offsetHeight:0;this.style.setProperty("--submenu-height",`${y}px`),this.style.setProperty("--submenu-opacity","1")});s(this,l,b(n(this,d),D));s(this,m,(e=n(this,i).activeItem)=>{!e||e!=n(this,i).activeItem||this.overflowHovered||(this.style.setProperty("--submenu-height","0px"),this.style.setProperty("--submenu-opacity","0"),this.dataset.overflowExpanded="false",n(this,i).activeItem=null,this.ariaExpanded="false",e.ariaExpanded="false",e.setAttribute("data-animating",""),setTimeout(()=>{e.removeAttribute("data-animating")},Math.max(0,this.animationDelay-150)))});s(this,o,b(n(this,m),H));s(this,h,()=>{this.querySelectorAll('img[loading="lazy"]')?.forEach(r=>r.removeAttribute("loading"))})}connectedCallback(){super.connectedCallback(),this.overflowMenu?.addEventListener("pointerleave",()=>n(this,o).call(this),{signal:n(this,u).signal}),x(n(this,h))}disconnectedCallback(){super.disconnectedCallback(),n(this,u).abort()}get animationDelay(){const e=this.dataset.animationDelay;return e?parseInt(e,10):0}get overflowMenu(){return this.refs.overflowMenu?.shadowRoot?.querySelector('[part="overflow"]')}get overflowHovered(){return this.refs.overflowMenu?.matches(":hover")??!1}deactivate(e){if(n(this,l).cancel(),!(e.target instanceof Element))return;v(e.target)===n(this,i).activeItem&&n(this,o).call(this)}}u=new WeakMap,i=new WeakMap,d=new WeakMap,l=new WeakMap,m=new WeakMap,o=new WeakMap,h=new WeakMap;customElements.get("header-menu")||customElements.define("header-menu",S);function v(t){return t instanceof Element?t?.matches('[slot="more"')?v(t.parentElement?.querySelector('[slot="overflow"]')):t?.querySelector('[ref="menuitem"]'):null}function q(t){const a=t?.parentElement?.querySelector('[ref="submenu[]"]');return a instanceof HTMLElement?a:null}
