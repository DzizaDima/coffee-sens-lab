var W=Object.defineProperty;var v=s=>{throw TypeError(s)};var B=(s,n,e)=>n in s?W(s,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[n]=e;var y=(s,n,e)=>B(s,typeof n!="symbol"?n+"":n,e),x=(s,n,e)=>n.has(s)||v("Cannot "+e);var h=(s,n,e)=>(x(s,n,"read from private field"),e?e.call(s):n.get(s)),u=(s,n,e)=>n.has(s)?v("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(s):n.set(s,e),L=(s,n,e,t)=>(x(s,n,"write to private field"),t?t.call(s,e):n.set(s,e),e),m=(s,n,e)=>(x(s,n,"access private method"),e);import{C as M}from"./component.js";import{c as Y,g as D,a as E,b as R}from"./utilities.js";import{S as T}from"./events.js";import{S as V}from"./scrolling.js";import{c as $}from"./focus.js";var d,c,b,g,S,w,C;class q extends M{constructor(){super(...arguments);u(this,c);y(this,"requiredRefs",["container"]);u(this,d);u(this,g,async e=>{if(!e.detail.userInitiated)return;const{index:t}=e.detail;if(t===this.currentIndex)return;const i=this.links[t];i&&(m(this,c,b).call(this,t),h(this,d).to(i))});u(this,w,()=>{const{links:e}=this,{container:t}=this.refs,i=D(this,e,.1);if(i.length===0)return;const l=i.map(p=>E(p,"x")),o=E(t,"x"),f=R(l,o),k=i[l.indexOf(f)];if(!k)return;const r=e.indexOf(k);this.select(r)})}connectedCallback(){super.connectedCallback(),this.addEventListener("keydown",m(this,c,S)),this.addEventListener(T.eventName,h(this,g)),L(this,d,new V(this.refs.container,{onScroll:h(this,w)}))}disconnectedCallback(){super.disconnectedCallback(),h(this,d).destroy()}get links(){return this.refs.links||[]}get currentIndex(){return this.links.findIndex(e=>e.getAttribute("aria-current")==="true")}select(e,t){m(this,c,b).call(this,e),this.refs.slideshow?.select(e,void 0,{animate:!1}),t&&m(this,c,C).call(this,t)}}d=new WeakMap,c=new WeakSet,b=function(e){const{links:t}=this,i=Y(e,0,t.length-1);for(const[l,o]of t.entries())o.setAttribute("aria-current",(l===i).toString())},g=new WeakMap,S=function(e){let t=0;switch(e.key){case"ArrowRight":case"ArrowDown":t=1;break;case"ArrowLeft":case"ArrowUp":t=-1;break}t&&(e.preventDefault(),$(this.links,t))},w=new WeakMap,C=function(e){if(!(e instanceof PointerEvent)||e.pointerType==="touch")return;const{target:t}=e;if(!(t instanceof HTMLElement))return;const{images:i}=this.refs,l=this.links.indexOf(t),o=i?.[l];if(!o)return;const f=r=>{const p=o.offsetHeight,A=o.offsetWidth,I=window.innerHeight,P=window.innerWidth,a=15,H=r.clientY+p+a>I?r.clientY-p-a:r.clientY+a,O=Math.min(Math.max(a,r.clientX+a),P-A-a);o.style.setProperty("--x",`${O}px`),o.style.setProperty("--y",`${H}px`)},k=()=>{o.removeAttribute("reveal"),t.removeEventListener("mousemove",f)};f(e);for(const r of i)r===o?r.setAttribute("reveal",""):r.removeAttribute("reveal");t.addEventListener("mousemove",f),t.addEventListener("mouseleave",k,{once:!0})};customElements.get("collection-links-component")||customElements.define("collection-links-component",q);
