var m=e=>{throw TypeError(e)};var h=(e,i,t)=>i.has(e)||m("Cannot "+t);var n=(e,i,t)=>(h(e,i,"read from private field"),t?t.call(e):i.get(e)),l=(e,i,t)=>i.has(e)?m("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,t),b=(e,i,t,a)=>(h(e,i,"write to private field"),a?a.call(e,t):i.set(e,t),t),f=(e,i,t)=>(h(e,i,"access private method"),t);import{C}from"./component.js";import{m as g}from"./morph.js";import{T as v}from"./events.js";import"./utilities.js";var o,c,A,d;class k extends C{constructor(){super(...arguments);l(this,c);l(this,o);l(this,d,t=>{if(!t)return;const a=f(this,c,A).call(this),s=this.dataset.productUrl;fetch(`${s}?variant=${t}&section_id=${this.dataset.sectionId}`,{signal:a.signal}).then(r=>r.text()).then(r=>{if(a.signal.aborted)return;const p=new DOMParser().parseFromString(r,"text/html").querySelector(`local-pickup[data-variant-id="${t}"]`);p?(this.removeAttribute("hidden"),g(this,p)):this.setAttribute("hidden","")}).catch(r=>{a.signal.aborted||this.setAttribute("hidden","")})})}connectedCallback(){super.connectedCallback();const t=this.closest(".shopify-section, dialog"),a=s=>{s.detail.data.newProduct&&(this.dataset.productUrl=s.detail.data.newProduct.url);const r=s.detail.resource?s.detail.resource.id:null,u=s.detail.resource?s.detail.resource.available:null;r!==this.dataset.variantId&&(r&&u?(this.removeAttribute("hidden"),this.dataset.variantId=r,n(this,d).call(this,r)):this.setAttribute("hidden",""))};t?.addEventListener(v.variantUpdate,a),this.disconnectedCallback=()=>{t?.removeEventListener(v.variantUpdate,a)}}}o=new WeakMap,c=new WeakSet,A=function(){return n(this,o)&&n(this,o).abort(),b(this,o,new AbortController),n(this,o)},d=new WeakMap;customElements.get("local-pickup")||customElements.define("local-pickup",k);
