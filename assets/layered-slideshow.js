var st=Object.defineProperty;var B=l=>{throw TypeError(l)};var it=(l,g,t)=>g in l?st(l,g,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[g]=t;var I=(l,g,t)=>it(l,typeof g!="symbol"?g+"":g,t),M=(l,g,t)=>g.has(l)||B("Cannot "+t);var n=(l,g,t)=>(M(l,g,"read from private field"),t?t.call(l):g.get(l)),v=(l,g,t)=>g.has(l)?B("Cannot add the same private member more than once"):g instanceof WeakSet?g.add(l):g.set(l,t),p=(l,g,t,e)=>(M(l,g,"write to private field"),e?e.call(l,t):g.set(l,t),t),a=(l,g,t)=>(M(l,g,"access private method"),t);import{C as nt}from"./component.js";import{i as P,m as $}from"./utilities.js";const rt=5,ot=.8,at=.5,ct=56,ht=44,lt='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';var u,h,x,b,A,E,C,s,H,D,V,G,K,X,j,k,T,N,z,S,w,R,Q,_,U,O,F,L,W,Z,J,Y;class gt extends nt{constructor(){super(...arguments);v(this,s);I(this,"requiredRefs",["container"]);v(this,u,0);v(this,h,null);v(this,x,null);v(this,b,!1);v(this,A,null);v(this,E,null);v(this,C,null);v(this,z,()=>{const t=n(this,b);if(p(this,b,P()),t!==n(this,b)){const{container:e}=this.refs;e.setAttribute("data-instant-transitions",""),a(this,s,J).call(this),a(this,s,F).call(this),a(this,s,w).call(this),a(this,s,D).call(this),requestAnimationFrame(()=>{e.removeAttribute("data-instant-transitions")})}})}connectedCallback(){super.connectedCallback();const{tabs:t}=this.refs;t?.length&&(p(this,u,Math.max(0,t.findIndex(e=>e.getAttribute("aria-selected")==="true"))),p(this,b,P()),$.addEventListener("change",n(this,z)),p(this,C,new ResizeObserver(e=>{for(const r of e)if(r.contentBoxSize){const i=r.contentBoxSize[0],o=n(this,b);let c;i?c=o?i.blockSize:i.inlineSize:c=o?r.contentRect.height:r.contentRect.width,a(this,s,R).call(this,c)}})),n(this,C).observe(this.refs.container),a(this,s,w).call(this),a(this,s,D).call(this),a(this,s,F).call(this))}disconnectedCallback(){super.disconnectedCallback(),n(this,x)?.abort(),n(this,A)?.disconnect(),p(this,A,null),n(this,E)?.disconnect(),p(this,E,null),n(this,C)?.disconnect(),p(this,C,null),$.removeEventListener("change",n(this,z))}select(t,{instant:e=!1}={}){a(this,s,S).call(this,t,e)}}u=new WeakMap,h=new WeakMap,x=new WeakMap,b=new WeakMap,A=new WeakMap,E=new WeakMap,C=new WeakMap,s=new WeakSet,H=function(){return n(this,b)?ht:ct},D=function(){n(this,x)?.abort(),p(this,x,new AbortController);const t={signal:n(this,x).signal},{container:e,tabs:r}=this.refs;this.addEventListener("keydown",i=>a(this,s,V).call(this,i),t);for(const[i,o]of r.entries())o.addEventListener("click",c=>a(this,s,G).call(this,c,i),t),o.addEventListener("focus",c=>a(this,s,K).call(this,c,i),t);a(this,s,X).call(this,t),n(this,b)||(e.addEventListener("pointerdown",i=>a(this,s,Q).call(this,i),t),e.addEventListener("click",i=>a(this,s,N).call(this,i),{...t,capture:!0}))},V=function(t){const e=t.target;if(e.getAttribute("role")!=="tab")return;const{tabs:r}=this.refs;if(!r)return;const i=r.indexOf(e),c={[n(this,b)?"ArrowUp":"ArrowLeft"]:-1,[n(this,b)?"ArrowDown":"ArrowRight"]:1,Home:-i,End:r.length-1-i}[t.key];if(c!==void 0){t.preventDefault();const d=(i+c+r.length)%r.length;r[d]?.focus(),a(this,s,S).call(this,d)}},G=function(t,e){t.preventDefault(),a(this,s,S).call(this,e)},K=function(t,e){t.target.matches(":focus-visible")&&a(this,s,S).call(this,e)},X=function(t){const{panels:e}=this.refs;if(e)for(const[r,i]of e.entries())i.addEventListener("keydown",o=>a(this,s,j).call(this,o,r),t)},j=function(t,e){if(t.key!=="Tab")return;const{panels:r}=this.refs,i=t.currentTarget,o=a(this,s,T).call(this,i),c=o[0],d=o[o.length-1];if(t.shiftKey){(c&&document.activeElement===c||!o.length&&document.activeElement===i)&&e>0&&(t.preventDefault(),a(this,s,S).call(this,e-1),a(this,s,k).call(this,e-1,"end"));return}(d&&document.activeElement===d||!o.length&&document.activeElement===i)&&r&&e<r.length-1&&(t.preventDefault(),a(this,s,S).call(this,e+1),a(this,s,k).call(this,e+1,"start"))},k=function(t,e="start"){const r=this.refs.panels?.[t];if(!r)return;const i=a(this,s,T).call(this,r),o=e==="end"?i[i.length-1]:i[0];requestAnimationFrame(()=>(o??r).focus())},T=function(t){return Array.from(t.querySelectorAll(lt)).filter(e=>!e.closest("[inert]")).map(e=>e)},N=function(t){const e=t.target;n(this,h)?.prevent&&e.closest('[role="tab"]')&&(t.stopImmediatePropagation(),t.preventDefault())},z=new WeakMap,S=function(t,e=!1){const{container:r,tabs:i}=this.refs;!i||t===n(this,u)||t<0||t>=i.length||(e&&r.setAttribute("data-instant-transitions",""),p(this,u,t),a(this,s,w).call(this),e&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{r.removeAttribute("data-instant-transitions")})}))},w=function(){const{tabs:t,panels:e}=this.refs;for(const[r,i]of t?.entries()??[]){const o=r===n(this,u);i.setAttribute("aria-selected",String(o)),i.setAttribute("tabindex",o?"0":"-1")}for(const[r,i]of e?.entries()??[]){const o=r===n(this,u);i.toggleAttribute("inert",!o),i.setAttribute("tabindex",o?"0":"-1");const c=i.querySelector("video");c&&(o?c.play():c.pause())}a(this,s,R).call(this)},R=function(t){const{container:e,tabs:r}=this.refs;if(!r)return;const i=n(this,s,H),c=(t??(n(this,b)?e.getBoundingClientRect().height:e.getBoundingClientRect().width))-i*(r.length-1),d=r.map((f,m)=>m===n(this,u)?`${c}px`:`${i}px`);e.style.setProperty("--active-tab",d.join(" "))},Q=function(t){if(n(this,b))return;const{tabs:e}=this.refs;if(!e)return;const i=t.target.closest('[role="tab"]');if(i){const o=e.indexOf(i);if(o===n(this,u))return;const c=o>n(this,u)?o+1:o;if(c>=e.length)return;a(this,s,_).call(this,t,c)}else a(this,s,_).call(this,t)},_=function(t,e){const{container:r,tabs:i}=this.refs;if(!i)return;const o=r.getBoundingClientRect().width,c=n(this,s,H),d=o-c*(i.length-1);p(this,h,{target:e??-1,start:t.clientX,max:o*ot,activeSize:d,left:e!==void 0?e>n(this,u):!1});const f=new AbortController,m={signal:f.signal};document.addEventListener("pointermove",y=>a(this,s,U).call(this,y),m),document.addEventListener("pointerup",()=>a(this,s,O).call(this,f),m),document.addEventListener("pointercancel",()=>a(this,s,O).call(this,f),m),t.preventDefault()},U=function(t){if(!n(this,h))return;const{container:e,tabs:r}=this.refs;if(!e||!r)return;const i=t.clientX-n(this,h).start,o=Math.abs(i);if(!n(this,h).dragging&&o>=rt){if(n(this,h).target===-1)if(i>0&&n(this,u)>0)n(this,h).target=n(this,u)-1,n(this,h).left=!1;else if(i<0&&n(this,u)<r.length-1)n(this,h).target=n(this,u)+1,n(this,h).left=!0;else return;n(this,h).dragging=!0,e.setAttribute("data-dragging","")}if(!n(this,h).dragging)return;const d=(n(this,h).left?i<0:i>0)?Math.min(o/n(this,h).max,1):0,f=n(this,s,H),m=n(this,h).activeSize,y=m-f,tt=r.map((dt,q)=>q===n(this,u)?`${Math.max(f,m-y*d)}px`:q===n(this,h)?.target?`${f+y*d}px`:`${f}px`);e.style.setProperty("--active-tab",tt.join(" ")),n(this,h).progress=d},O=function(t){if(!n(this,h))return;const{container:e}=this.refs;e?.removeAttribute("data-dragging"),n(this,h).dragging?(n(this,h).prevent=!0,setTimeout(()=>p(this,h,null),100),n(this,h).progress&&n(this,h).progress>=at?a(this,s,S).call(this,n(this,h).target):a(this,s,w).call(this)):p(this,h,null),t.abort()},F=function(){const{panels:t}=this.refs;n(this,A)?.disconnect(),p(this,A,new ResizeObserver(()=>a(this,s,L).call(this))),n(this,E)?.disconnect(),p(this,E,new MutationObserver(()=>a(this,s,L).call(this)));for(const e of t??[]){const r=e.querySelector(".layered-slideshow__content"),i=r?.querySelector(".group-block-content");i&&n(this,A).observe(i),r&&n(this,A).observe(r);const o=i??r;o&&n(this,E).observe(o,{childList:!0,subtree:!0,characterData:!0})}a(this,s,L).call(this)},L=function(){const{container:t}=this.refs,e=a(this,s,Y).call(this),r=t.getAttribute("size")==="auto";n(this,b)?a(this,s,Z).call(this,e,r):a(this,s,W).call(this,e,r)},W=function(t,e){const{container:r}=this.refs;if(e){let i=Math.max(t,150);r.style.height=`${i}px`,this.style.minHeight=`${i}px`}else{const i=this.style.minHeight;this.style.minHeight="";const o=parseFloat(getComputedStyle(this).minHeight)||0;this.style.minHeight=i,t>o?(this.style.minHeight=`${t}px`,r.style.height=`${t}px`):(this.style.minHeight="",r.style.height="")}},Z=function(t,e){const{container:r,tabs:i}=this.refs;if(!r||!i)return;const o=getComputedStyle(r),c=(i.length-1)*n(this,s,H);let d;if(e)d=150;else{const m=o.getPropertyValue("--layered-panel-height-mobile"),y=getComputedStyle(this).getPropertyValue("--layered-panel-height-mobile");d=parseFloat(m||y)||260}const f=Math.max(d,t);r.style.setProperty("--active-panel-height",`${f}px`),r.style.height=`${f+c}px`},J=function(){const{container:t}=this.refs;this.style.minHeight="",t.style.height="",t.style.removeProperty("--active-panel-height")},Y=function(){const{panels:t}=this.refs;let e=0;for(const r of t??[]){const i=r.querySelector(".layered-slideshow__content");if(!i)continue;const o=i.querySelector(".group-block-content")??i,c=o.style.height;o.style.height="auto";const d=getComputedStyle(i),f=parseFloat(d.paddingBlockStart||d.paddingTop)||0,m=parseFloat(d.paddingBlockEnd||d.paddingBottom)||0,y=(o.scrollHeight||0)+f+m;y>e&&(e=y),o.style.height=c}return e};customElements.define("layered-slideshow-component",gt);
