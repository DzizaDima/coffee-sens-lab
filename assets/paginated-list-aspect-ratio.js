var g=a=>{throw TypeError(a)};var l=(a,t,e)=>t.has(a)||g("Cannot "+e);var u=(a,t,e)=>(l(a,t,"read from private field"),e?e.call(a):t.get(a)),p=(a,t,e)=>t.has(a)?g("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,e),R=(a,t,e,r)=>(l(a,t,"write to private field"),r?r.call(a,e):t.set(a,e),e),s=(a,t,e)=>(l(a,t,"access private method"),e);var c,h,i,E,S,M,H,T,d,f,L;class C{constructor({templateCard:t}){p(this,i);p(this,c,null);p(this,h,{square:"1",portrait:"0.8",landscape:"1.778"});Shopify.designMode&&s(this,i,E).call(this,t)}processNewElements(){Shopify.designMode&&requestAnimationFrame(()=>{u(this,c)==="adapt"?s(this,i,S).call(this):s(this,i,M).call(this)})}}c=new WeakMap,h=new WeakMap,i=new WeakSet,E=function(t){R(this,c,t.getAttribute("data-image-ratio"))},S=function(){const t=s(this,i,f).call(this);if(!t.length)return;const e=new Map;t.forEach(r=>{if(!(r instanceof HTMLElement))return;const n=r.getAttribute("data-product-id");if(n&&e.has(n)){s(this,i,d).call(this,r,e.get(n));return}const o=r.querySelector("img");if(!o){s(this,i,d).call(this,r,"1");return}const m=()=>{if(!o.naturalWidth||!o.naturalHeight)return;const A=s(this,i,H).call(this,o.naturalWidth,o.naturalHeight);n&&e.set(n,A),s(this,i,d).call(this,r,A)};o.complete?m():o.addEventListener("load",m,{once:!0})})},M=function(){if(!u(this,c))return;const t=s(this,i,T).call(this,u(this,c));if(!t)return;const e=s(this,i,f).call(this);e.length&&requestAnimationFrame(()=>{e.forEach(r=>{r instanceof HTMLElement&&s(this,i,d).call(this,r,t)})})},H=function(t,e){const r=t/e;return Math.max(.1,Math.min(10,r)).toFixed(3)},T=function(t){return u(this,h)[t]||null},d=function(t,e){if(!(t instanceof HTMLElement))return;t.style.setProperty("--gallery-aspect-ratio",e),t.querySelectorAll(".product-media-container").forEach(n=>{n instanceof HTMLElement&&(n.style.aspectRatio=e)}),s(this,i,L).call(this,t)},f=function(){return document.querySelectorAll(".card-gallery:not([data-aspect-ratio-applied])")},L=function(t){t instanceof HTMLElement&&t.setAttribute("data-aspect-ratio-applied","true")};export{C as P};
