var a=Object.defineProperty;var c=(i,s,e)=>s in i?a(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e;var r=(i,s,e)=>c(i,typeof s!="symbol"?s+"":s,e);import{C as m}from"./component.js";import{e as d}from"./utilities.js";class l extends m{constructor(){super();r(this,"requiredRefs",["mediaWrapper","slider","afterImage"]);this.hasAnimated=!1,this.boundHandleIntersection=this.handleIntersection.bind(this)}connectedCallback(){super.connectedCallback();const{mediaWrapper:e}=this.refs;this.orientation=e.dataset.orientation||"horizontal",this.sync(),this.setupIntersectionObserver()}sync(){const{mediaWrapper:e,slider:t}=this.refs;if(this.isAnimating)return;const n=(Number(t.value)-Number(t.min))/(Number(t.max)-Number(t.min)),o=Math.round(n*100);e.style.setProperty("--compare",String(o))}disconnectedCallback(){this.intersectionObserver&&this.intersectionObserver.disconnect()}setValue(e){const{slider:t}=this.refs;t&&(t.value=String(e),this.sync())}animateSlider(){const{mediaWrapper:e,slider:t}=this.refs;this.hasAnimated||(this.hasAnimated=!0,this.isAnimating=!0,e.style.setProperty("--transition-duration","0.5s"),setTimeout(()=>{e.style.setProperty("--compare","40")},100),setTimeout(()=>{e.style.setProperty("--compare","60")},600),setTimeout(()=>{e.style.setProperty("--compare","50")},1100),setTimeout(()=>{e.style.setProperty("--transition-duration","0s"),t.value="50",this.isAnimating=!1},1600))}setupIntersectionObserver(){if(!window.IntersectionObserver)return;const e={root:null,rootMargin:"0px",threshold:.5};this.intersectionObserver=new IntersectionObserver(this.boundHandleIntersection,e),this.intersectionObserver.observe(this)}handleIntersection(e){e.forEach(t=>{t.isIntersecting&&!this.hasAnimated&&(setTimeout(()=>{d(this,"comparison-slider-animated",()=>{this.animateSlider()})},300),this.intersectionObserver&&this.intersectionObserver.disconnect())})}}customElements.get("comparison-slider-component")||customElements.define("comparison-slider-component",l);
