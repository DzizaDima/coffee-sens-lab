var H=o=>{throw TypeError(o)};var R=(o,r,e)=>r.has(o)||H("Cannot "+e);var t=(o,r,e)=>(R(o,r,"read from private field"),e?e.call(o):r.get(o)),h=(o,r,e)=>r.has(o)?H("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(o):r.set(o,e),C=(o,r,e,s)=>(R(o,r,"write to private field"),s?s.call(o,e):r.set(o,e),e),l=(o,r,e)=>(R(o,r,"access private method"),e);import{R as B}from"./utilities.js";import{D as N}from"./component.js";class U extends Event{constructor(r){super("overflowMinimum",{bubbles:!0}),this.detail={minimumReached:r}}}var i,k,$,y,I,P,q,z,D,p,x,O,a,g,L,b;class V extends N{constructor(){super(...arguments);h(this,i);h(this,y,!1);h(this,I,e=>{const s=e[0];s?.isIntersecting&&(t(this,b).disconnect(),setTimeout(()=>{this.querySelector(':scope > template[shadowrootmode="open"]')?.remove(),t(this,p).call(this,s.boundingClientRect.height)},0))});h(this,P,()=>{t(this,y)||(C(this,y,!0),requestAnimationFrame(()=>setTimeout(()=>{t(this,p).call(this),C(this,y,!1)},0)))});h(this,p,(e=0,s=null)=>{const{defaultSlot:n,overflowSlot:T,moreSlot:m,list:d,placeholder:v}=t(this,a);l(this,i,O).call(this),l(this,i,q).call(this);const u=n.assignedElements();if(!u[u.length-1]){l(this,i,x).call(this);return}let w=[],c=[],A=0,S=!1;e>0&&d.style.setProperty("height",`${e}px`),d.style.setProperty("flex-wrap","wrap"),v.hidden=!0,m.style.setProperty("order","-1"),m.hidden=!1,s?.style.setProperty("order","-1");const F=m.getBoundingClientRect();u.forEach(f=>{const E=f.getBoundingClientRect();E.top>F.top?(c.length||(A=E.width),S=!0,c.push(f)):w.push(f)}),S&&m.style.removeProperty("order"),s?.style.removeProperty("order");for(const f of u){const E=c.includes(f)?T.name:n.name;f.slot!==E&&(f.slot=E)}d.style.setProperty("counter-reset",`overflow-count ${c.length}`),this.style.setProperty("--overflow-count",`${c.length}`),m.hidden=!S,S&&(v.style.width=`${A}px`,v.hidden=!1),d.style.setProperty("overflow","unset"),S&&l(this,i,D).call(this,w),l(this,i,x).call(this)});h(this,a);h(this,g,new B(t(this,P)));h(this,L,new MutationObserver(t(this,P)));h(this,b,new IntersectionObserver(t(this,I),{rootMargin:"640px 360px 640px 360px"}))}static get observedAttributes(){return["disabled","minimum-items"]}attributeChangedCallback(e,s,n){e==="disabled"&&(n==="true"?l(this,i,z).call(this):t(this,p).call(this))}async connectedCallback(){super.connectedCallback(),await l(this,i,k).call(this),l(this,i,$).call(this)}disconnectedCallback(){t(this,g).disconnect()}get schedule(){return typeof Theme?.utilities?.scheduler?.schedule=="function"?Theme.utilities.scheduler.schedule:e=>requestAnimationFrame(()=>setTimeout(e,0))}get minimumItems(){const e=this.getAttribute("minimum-items");return e?parseInt(e,10):null}get overflowSlot(){const{overflowSlot:e}=t(this,a);return e}get defaultSlot(){const{defaultSlot:e}=t(this,a);return e}showAll(){const{placeholder:e}=t(this,a);e.style.setProperty("width","0"),e.style.setProperty("display","none"),this.setAttribute("disabled","true")}}i=new WeakSet,k=function(){const e=this.shadowRoot?.querySelector('link[rel="stylesheet"]');return!e||e.sheet?Promise.resolve():new Promise(s=>{e.addEventListener("load",s)})},$=function(){const{shadowRoot:e}=this;if(!e)throw new Error("Missing shadow root");const s=e.querySelector("slot:not([name])"),n=e.querySelector('slot[name="overflow"]'),T=e.querySelector('slot[name="more"]'),m=e.querySelector('[part="overflow"]'),d=e.querySelector('[part="list"]'),v=e.querySelector('[part="placeholder"]');if(!(s instanceof HTMLSlotElement)||!(n instanceof HTMLSlotElement)||!(T instanceof HTMLSlotElement)||!(m instanceof HTMLElement)||!(d instanceof HTMLUListElement)||!(v instanceof HTMLLIElement))throw new Error("Invalid element types in <OverflowList />");C(this,a,{defaultSlot:s,overflowSlot:n,moreSlot:T,overflow:m,list:d,placeholder:v}),this.addEventListener("reflow",c=>{t(this,p).call(this,0,c.detail.lastVisibleElement)});const u=s.assignedElements().filter(c=>!(c instanceof HTMLTemplateElement)),M=u[0],w=u[u.length-1];M&&t(this,b).observe(M),w&&w!==M&&t(this,b).observe(w)},y=new WeakMap,I=new WeakMap,P=new WeakMap,q=function(){const{defaultSlot:e,overflowSlot:s}=t(this,a);for(const n of s.assignedElements())n.slot!==e.name&&(n.slot=e.name)},z=function(){const{list:e}=t(this,a);l(this,i,O).call(this),l(this,i,q).call(this),e.style.removeProperty("height"),this.style.setProperty("--overflow-count","0")},D=function(e){if(this.minimumItems!==null){const s=e.length<this.minimumItems;s?this.setAttribute("minimum-reached",""):this.removeAttribute("minimum-reached"),this.dispatchEvent(new U(s))}},p=new WeakMap,x=function(){t(this,g).observe(this),t(this,L).observe(this,{childList:!0})},O=function(){t(this,g).disconnect(),t(this,L).disconnect()},a=new WeakMap,g=new WeakMap,L=new WeakMap,b=new WeakMap;customElements.get("overflow-list")||customElements.define("overflow-list",V);export{V as O};
