var S=Object.defineProperty;var O=n=>{throw TypeError(n)};var U=(n,s,e)=>s in n?S(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e;var R=(n,s,e)=>U(n,typeof s!="symbol"?s+"":s,e),C=(n,s,e)=>s.has(n)||O("Cannot "+e);var u=(n,s,e)=>(C(n,s,"read from private field"),e?e.call(n):s.get(n)),h=(n,s,e)=>s.has(n)?O("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(n):s.set(n,e),p=(n,s,e,t)=>(C(n,s,"write to private field"),t?t.call(n,e):s.set(n,e),e),o=(n,s,e)=>(C(n,s,"access private method"),e);import{C as V}from"./component.js";import{d as k}from"./utilities.js";const b={duration:500};var m,l,r,v,q,g,A,f,L,y,I,M;class W extends V{constructor(){super(...arguments);h(this,r);R(this,"requiredRefs",["wrapper","content","marqueeItems"]);h(this,m,null);h(this,l,k(()=>{if(u(this,m))return;const e=this.refs.wrapper.getAnimations()[0];e&&p(this,m,T({...b,from:1,to:0,onUpdate:t=>e.updatePlaybackRate(t),onComplete:()=>{p(this,m,null)}}))},b.duration));h(this,f,k(async()=>{const{marqueeItems:e}=this.refs,t=await o(this,r,g).call(this),i=e.length,c=o(this,r,A).call(this,t);t>i?o(this,r,I).call(this,t-i):t<i&&o(this,r,M).call(this,i-t),o(this,r,y).call(this),o(this,r,q).call(this,c),o(this,r,L).call(this)},250))}async connectedCallback(){super.connectedCallback();const{marqueeItems:e}=this.refs;if(e.length===0)return;const t=await o(this,r,g).call(this),i=o(this,r,A).call(this,t);o(this,r,I).call(this,t),o(this,r,y).call(this),o(this,r,q).call(this,i),window.addEventListener("resize",u(this,f)),this.addEventListener("pointerenter",u(this,l)),this.addEventListener("pointerleave",o(this,r,v))}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("resize",u(this,f)),this.removeEventListener("pointerenter",u(this,l)),this.removeEventListener("pointerleave",o(this,r,v))}get clonedContent(){const{content:e,wrapper:t}=this.refs,i=t.lastElementChild;return e!==i?i:null}}m=new WeakMap,l=new WeakMap,r=new WeakSet,v=function(){u(this,l).cancel();const e=this.refs.wrapper.getAnimations()[0];if(!e||e.playbackRate===1)return;const t=u(this,m)?.current??0;u(this,m)?.cancel(),p(this,m,T({...b,from:t,to:1,onUpdate:i=>e.updatePlaybackRate(i),onComplete:()=>{p(this,m,null)}}))},q=function(e){this.style.setProperty("--marquee-speed",`${e}s`)},g=async function(){const{marqueeItems:e}=this.refs;return new Promise(t=>{if(!e[0])return setTimeout(()=>t(1),0);const i=new IntersectionObserver(c=>{const a=c[0];if(!a)return;i.disconnect();const{width:w}=a.rootBounds??{width:0},{width:d}=a.boundingClientRect;setTimeout(()=>{t(d===0?1:Math.ceil(w/d))},0)},{root:this});i.observe(e[0])})},A=function(e){const t=Number(this.getAttribute("data-speed-factor"));return Math.sqrt(e)*t},f=new WeakMap,L=function(){const e=this.refs.wrapper.getAnimations();requestAnimationFrame(()=>{for(const t of e)t.currentTime=0})},y=function(){this.clonedContent?.remove();const e=this.refs.content.cloneNode(!0);e.setAttribute("aria-hidden","true"),e.removeAttribute("ref"),this.refs.wrapper.appendChild(e)},I=function(e){const{content:t,marqueeItems:i}=this.refs;if(i[0])for(let c=0;c<e-1;c++){const a=i[0].cloneNode(!0);t.appendChild(a)}},M=function(e){const{content:t}=this.refs,i=Array.from(t.children),c=Math.min(e,i.length-1);for(let a=0;a<c;a++)t.lastElementChild?.remove()};function T({from:n,to:s,duration:e,onUpdate:t,easing:i=a=>a*a*(3-2*a),onComplete:c}){const a=performance.now();let w=!1,d=n;function E(P){if(w)return;const F=P-a,N=Math.min(F/e,1),z=i(N);d=n+(s-n)*z,t(d),N<1?requestAnimationFrame(E):typeof c=="function"&&c()}return requestAnimationFrame(E),{get current(){return d},cancel(){w=!0}}}customElements.get("marquee-component")||customElements.define("marquee-component",W);
